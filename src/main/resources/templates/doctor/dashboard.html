<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{doctor/layout/main}">
<head>
    <title>Doctor Dashboard</title>
    <!-- Additional CSS specific to the dashboard -->
    <th:block layout:fragment="css">
        <style>
            .dashboard-card {
                transition: transform 0.3s ease;
            }
            .dashboard-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            }
            .card-icon {
                font-size: 2rem;
                margin-bottom: 0.5rem;
            }
        </style>
    </th:block>
</head>
<body>
    <!-- Page Title -->
    <h2 layout:fragment="page-title">Dashboard</h2>

    <!-- Page Actions -->
    <div layout:fragment="page-actions">
        <button class="btn btn-outline-primary">
            <i class="fas fa-sync-alt"></i> Refresh
        </button>
    </div>

    <!-- Main Content -->
    <div layout:fragment="content">
        <!-- Overview Cards -->
        <div class="row mb-4">
            <!-- Today's Appointments Card -->
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card dashboard-card h-100 border-left-primary">
                    <div class="card-body">
                        <div class="text-center">
                            <i class="fas fa-calendar-day card-icon text-primary"></i>
                            <h5 class="card-title">Today's Appointments</h5>
                            <h2 class="display-4" th:text="${todayAppointments.size()}">0</h2>
                            <a th:href="@{/doctor/appointments/today(doctorId=${doctorId})}" class="btn btn-sm btn-primary mt-2">
                                View Details
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Upcoming Appointments Card -->
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card dashboard-card h-100 border-left-success">
                    <div class="card-body">
                        <div class="text-center">
                            <i class="fas fa-calendar-week card-icon text-success"></i>
                            <h5 class="card-title">Upcoming Appointments</h5>
                            <h2 class="display-4" th:text="${upcomingAppointments.size()}">0</h2>
                            <a th:href="@{/doctor/appointments/upcoming(doctorId=${doctorId})}" class="btn btn-sm btn-success mt-2">
                                View Details
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pending Medical Orders Card -->
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card dashboard-card h-100 border-left-warning">
                    <div class="card-body">
                        <div class="text-center">
                            <i class="fas fa-clipboard-list card-icon text-warning"></i>
                            <h5 class="card-title">Pending Orders</h5>
                            <h2 class="display-4" th:text="${pendingOrders.size()}">0</h2>
                            <a th:href="@{/doctor/medical-orders/status(doctorId=${doctorId}, status='PENDING')}" class="btn btn-sm btn-warning mt-2">
                                View Details
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Total Patients Card -->
            <div class="col-md-6 col-lg-3 mb-3">
                <div class="card dashboard-card h-100 border-left-info">
                    <div class="card-body">
                        <div class="text-center">
                            <i class="fas fa-users card-icon text-info"></i>
                            <h5 class="card-title">Total Patients</h5>
                            <h2 class="display-4" th:text="${patientCount}">0</h2>
                            <a th:href="@{/doctor/patients(doctorId=${doctorId})}" class="btn btn-sm btn-info mt-2">
                                View Details
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Today's Appointments Table -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="fas fa-calendar-day"></i> Today's Appointments
                </h5>
                <a th:href="@{/doctor/appointments/today(doctorId=${doctorId})}" class="btn btn-sm btn-light">
                    View All
                </a>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover table-striped">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Patient Name</th>
                                <th>Purpose</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:if="${#lists.isEmpty(todayAppointments)}">
                                <td colspan="5" class="text-center">No appointments scheduled for today</td>
                            </tr>
                            <tr th:each="appointment : ${todayAppointments}">
                                <td th:text="${#temporals.format(appointment.dateTime, 'HH:mm')}">09:00</td>
                                <td th:text="${appointment.patientName}">John Doe</td>
                                <td th:text="${appointment.purpose}">Consultation</td>
                                <td>
                                    <span th:class="${'badge ' + (#strings.equals(appointment.status, 'SCHEDULED') ? 'bg-warning' :
                                     (#strings.equals(appointment.status, 'COMPLETED') ? 'bg-success' :
                                     (#strings.equals(appointment.status, 'CANCELLED') ? 'bg-danger' :
                                     (#strings.equals(appointment.status, 'IN_PROGRESS') ? 'bg-primary' : 'bg-secondary'))))}"
                                    th:text="${appointment.status}">SCHEDULED</span>
                                </td>
                                <td>
                                    <a th:href="@{/doctor/appointment/{id}(id=${appointment.id}, doctorId=${doctorId})}"
                                       class="btn btn-sm btn-primary">
                                        <i class="fas fa-eye"></i> View
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Upcoming Appointments Table -->
        <div class="card mb-4">
            <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="fas fa-calendar-week"></i> Upcoming Appointments
                </h5>
                <a th:href="@{/doctor/appointments/upcoming(doctorId=${doctorId})}" class="btn btn-sm btn-light">
                    View All
                </a>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover table-striped">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Time</th>
                                <th>Patient Name</th>
                                <th>Purpose</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:if="${#lists.isEmpty(upcomingAppointments)}">
                                <td colspan="5" class="text-center">No upcoming appointments</td>
                            </tr>
                            <tr th:each="appointment : ${upcomingAppointments}">
                                <td th:text="${#temporals.format(appointment.dateTime, 'dd MMM yyyy')}">25 May 2025</td>
                                <td th:text="${#temporals.format(appointment.dateTime, 'HH:mm')}">09:00</td>
                                <td th:text="${appointment.patientName}">John Doe</td>
                                <td th:text="${appointment.purpose}">Consultation</td>
                                <td>
                                    <a th:href="@{/doctor/appointment/{id}(id=${appointment.id}, doctorId=${doctorId})}"
                                       class="btn btn-sm btn-success">
                                        <i class="fas fa-eye"></i> View
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Pending Medical Orders Section -->
        <div class="card">
            <div class="card-header bg-warning text-dark d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="fas fa-clipboard-list"></i> Pending Medical Orders
                </h5>
                <a th:href="@{/doctor/medical-orders/status(doctorId=${doctorId}, status='PENDING')}" class="btn btn-sm btn-dark">
                    View All
                </a>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover table-striped">
                        <thead>
                            <tr>
                                <th>Order Date</th>
                                <th>Patient</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:if="${#lists.isEmpty(pendingOrders)}">
                                <td colspan="5" class="text-center">No pending medical orders</td>
                            </tr>
                            <tr th:each="order : ${pendingOrders}">
                                <td th:text="${#temporals.format(order.orderDate, 'dd MMM yyyy')}">25 May 2025</td>
                                <td th:text="${order.patientName}">John Doe</td>
                                <td th:text="${order.orderType}">LAB_TEST</td>
                                <td th:text="${order.description}">Blood Test</td>
                                <td>
                                    <a href="#" class="btn btn-sm btn-warning">
                                        <i class="fas fa-eye"></i> View
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Additional JavaScript specific to the dashboard -->
    <th:block layout:fragment="js">
        <script>
            // Any dashboard-specific JavaScript can go here
            document.addEventListener('DOMContentLoaded', function() {
                console.log('Dashboard loaded');
                // You can add any dashboard-specific initialization here
            });
        </script>
    </th:block>
</body>
</html>

